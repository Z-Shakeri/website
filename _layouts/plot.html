---
layout: default
---

<div class="page plot-page">

    <p class="paper-info">
        The visualizations and data on this page...
    </p>

    <div class="plot-page-container">
        <p class="title">{{ page.title }}</p>
        <p class="subtitle">{{ page.subtitle }}</p>

       

        <div class="inner">
            <div class="top-actions">
                <a href="https://github.com/hms-dbmi/c19i2b2-notebooks/blob/master/notebooks/{{ page.notebook }}" target="_blank">View Jupyter Notebook</a>
                <button id="expand-width">Expand</button>
            </div>

            <div class="plot-container">
                {% for plot in page.plots %}
                    {% assign plot_type = plot | to_plot_type %}
                    <div id="{{ plot | to_plot_id }}" class="{{ plot_type }}-plot-type"></div>
                {%  endfor %}
            </div>

            <div class="description">
                {{ content }}
            </div>
        </div>
    </div>

    <h3>Source Code</h3>
    <p>
        These plots on this page were developed in Python and R notebooks.
        These notebooks are located in the <a href="https://github.com/covidclinical/notebooks">covidclinical/notebooks</a> GitHub repository.
        The code used to generate this website is located in the <a href="https://github.com/covidclinical/notebooks">covidclinical/website</a> GitHub repository.
    </p>

</div>

<!-- External -->
<script type="text/javascript" src="{{ "/assets/js/vega.js" | relative_url }}"></script>
<script type="text/javascript" src="{{ "/assets/js/vega-lite.js" | relative_url }}"></script>
<script type="text/javascript" src="{{ "/assets/js/vega-embed.js" | relative_url }}"></script>
<script type="text/javascript" src="{{ "/assets/js/d3-fetch.js" | relative_url }}"></script>
<script type="text/javascript" src="{{ "/assets/js/lineup.js" | relative_url }}"></script>

<!-- Plots -->
<script type="text/javascript">

    function unknownEmbed() {
        console.log("Unknown plot type.");
    }

    function lineupEmbed(selector, fileUrl, options) {
        const el = document.querySelector(selector);

        d3.json(fileUrl).then(function(data) {
            const lineup = LineUpJS.asLineUp(el, data);
        });
    }

    function renderPlots() {
        let plotEmbed;
        {% for plot in page.plots %}
            {% assign plot_type = plot | to_plot_type %}
            {% case plot_type %}
                {%  when "vega" %}
                    plotEmbed = vegaEmbed;
                {%  when "lineup" %}
                    plotEmbed = lineupEmbed;
                {% else %}
                    plotEmbed = unknownEmbed;
            {% endcase %}

            plotEmbed(
                "#{{ plot | to_plot_id }}",
                "{{ plot | to_plot_url: page.url }}",
                {
                    renderer: "canvas",
                    downloadFileName: "4CE-COVID-19_{{ plot | to_plot_id }}",
                    actions: {
                        export: true,
                        editor: false,
                        compiled: false,
                        source: false,
                    }
                }
            );
        {% endfor %}
    }

    window.onload = renderPlots;


    const expandButton = document.querySelector('#expand-width');
    expandButton.addEventListener('click', () => {
        const wrapper = document.querySelector('.page-content .wrapper');

        if(wrapper) {
            wrapper.classList.toggle("wrapper-wide");
            renderPlots();

            if(wrapper.classList.contains("wrapper-wide")) {
                expandButton.innerHTML = "Minimize";
            } else {
                expandButton.innerHTML = "Expand";
            }
        }
    });
</script>